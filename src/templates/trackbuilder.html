<div id="page-title">Track Builder</div>

<div growl inline="true"></div>

<div id="track-builder" ng-show="showtrackbuilder">

	<div class="row" ng-controller="ModalDemoCtrl" class="ng-scope">
		<div class="content-addition col-sm-2">
			<div class="description"><p>Add Video</p></div>
			<div class="link-button">
				<a href="#" ng-click="open()"><i class="fa fa-fw fa-plus"></i></a>
			</div>
		</div>
		<div class="content-addition col-sm-2">
			<div class="description"><p>Add Document</p></div>
			<div class="link-button"><a href="#modal-edit-document-module" data-toggle="modal"><i class="fa fa-fw fa-plus"></i></a></div>
		</div>
		<div class="content-addition col-sm-2">
			<div class="description"><p>Make Base Track</p></div>
		    <div class="checkbox"><input type="checkbox" ng-model="course.baseTrack" ng-change="baseTrack()"></div>
		</div>
		<div class="content-addition col-sm-2" ng-show="user.role != 'sales'">
			<div class="description"><p>Share Track with Team</p></div>
			<div class="checkbox"><input type="checkbox" ng-model="course.shareWithTeam" ng-change="baseTrack()"></div>
		</div>	 

		<script type="text/ng-template" id="myModalContent.html">
			<div class="modal fade" id="modal-edit-video-module" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
				<div class="modal-dialog" role="document">
					<div class="modal-content">
						<div class="modal-header">
							<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
							<h4 class="modal-title" id="myModalLabel">Add Video Module</h4>
							<div growl inline="true"></div>
						</div>
						<div class="modal-body"></div>
						<div class="modal-footer">
							<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
							<button type="submit" class="btn btn-primary" ng-click="addVideoToTrack('video')">Add to track</button>
						</div>
					</div>
				</div>
			</div>
		</script>   
	</div>

	<div class="row">
		<div id="current-track" class="col-sm-9">
			<div class="sub-title">Current Track : {{course.title}}</div>
			<div class="panel panel-default paper-shadow" data-z="0.5">
				<p ng-if="!course.contents || course.contents.length == 0">No tracks added..</p>
				<table ui-tree="tableCallbacks" class="table table-responsive">
					<tbody class="draglist" ui-tree-nodes ng-model="course.contents">
						<tr ng-repeat="content in course.contents" ui-tree-node>
							<td scope="row"><i class="glyphicon glyphicon-resize-vertical" ui-tree-handle></i></td>
							<td class="document-type-img">
								<img ng-if="content.type != 'document'" src="img/icons/video-inline.jpg" alt="people" class="img-square width-30" />
								<img ng-if="content.type == 'document'" src="img/icons/document.jpg" alt="people" class="img-square width-30" />
							</td>
							<td>{{content.title}}</td>
							<td><button class="btn btn-danger btn-xs" data-title="Delete" ng-click="deleteTrack($index)"><span class="glyphicon glyphicon-trash"></span></button></td>
						</tr>
					</tbody>
				</table>
			</div>
		</div>

		<div id="client-addition" class="col-sm-3">
			<div class="sub-title">Clients</div>
			<div class="panel panel-default paper-shadow" data-z="0.5">
				<div class="panel-body">
					<table class="table table-striped table-bordered" st-table="displayedStudentCourseCollection" st-safe-src="studentcourses">
						<thead>
							<tr class="search-row">
								<th colspan="2"><input class="form-control search" st-search="" placeholder="Enter text to start searching..." type="text" /></th>
							</tr>
							<tr>
								<th class="header" st-sort="inviteurl">Client<i class="fa fa-sort"></i></th>
								<th class="header" st-sort="fullname">Link<i class="fa fa-sort"></i></th>
							</tr>
						</thead>
						<tbody>
							<tr ng-repeat="studentcourse in displayedStudentCourseCollection">
								<td>{{studentcourse.studentID.local.email}}</td>
								<td><a href="" class="text-warning" clip-copy="studentcourse.inviteurl" clip-click="showMessage()">Copy invite link</a></td>
							</tr>
						</tbody>
						<tfoot>
							<tr>
								<td colspan="5" class="text-center">
									<div st-pagination="" st-items-by-page="6" st-displayed-pages="7"></div>
								</td>
							</tr>
						</tfoot>
					</table>
				</div>
				<div class="panel-footer">
					<a class="button-orange" href="#" role="button" data-toggle="modal" data-target="#inviteClient">Add Client</a>
				</div>
			</div>
		</div>
	</div>

</div>

<div class="modal fade" id="modal-edit-document-module" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
	<div class="modal-dialog" role="document">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
				<h4 class="modal-title" id="myModalLabel">Add Document Module</h4>
				<div growl inline="true"></div>
			</div>
			<div class="modal-body">
				<table ng-table="tableParams" class="table table table-condensed table-bordered table-striped" show-filter="true">
					<tr ng-repeat="doc in $data | filter:{type: 'document'}">
						<td title="'Select'">
							<input id="checkbox3" type="checkbox" ng-model="doc.selected" ng-change="addVideoToQueue(doc.selected,doc)">
						</td>
						<td title="'#'" sortable="'#'">
							{{$index +1 }}
						</td>
						<td title="'Name'" sortable="'name'">
							{{doc.title}}
						</td>
						<td title="'Uploaded on'" sortable="'createdOn'">
							<span am-time-ago="doc.createdOn"></span>
						</td>
					</tr>
				</table>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
				<button type="submit" class="btn btn-primary" ng-click="addVideoToTrack('document')">Add to track</button>
			</div>
		</div>
	</div>
</div>

<div class="panel panel-default" ng-show="!showtrackbuilder">
	<div class="panel-body">
		<form name="myForm" ng-submit="addTrack()">
			<div class="form-group">
				<label for="inputEmail3" class="control-label">Title</label>
				<div class="form-control-material">
					<input type="text" class="form-control" id="course.title" placeholder="Type here.." ng-required="true" ng-model="course.title"><span class="ma-form-highlight" required></span><span class="ma-form-bar"></span>
				</div>
			</div>
			<div class="form-group">
				<label class="control-label">Description</label>
				<div class="form-control-material">
					<textarea id="description" class="form-control" rows="5" ng-model="course.description"></textarea><span class="ma-form-highlight"></span><span class="ma-form-bar"></span>
				</div>
			</div>
			<button type="submit" class="btn btn-primary">Next</button>
		</form>
	</div>
</div>

<div class="modal {{showInviteClientModal}}" id="inviteClient" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
	<div class="modal-dialog" role="document">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
				<h4 class="modal-title" id="myModalLabel">Invite Client</h4>
				<div growl inline="true"></div>
			</div>
			<form role="form" ng-submit="inviteClient()">
				<div class="modal-body">
					<div class="form-group">
						<label for="email">Client's Email address:</label>
						<input type="email" class="form-control" id="email" ng-model="student.local.email">
					</div>
					<div class="form-group">
						<label for="firstname">Client's First name:</label>
						<input type="text" class="form-control" id="firstname" ng-model="student.local.firstname">
					</div>
					<div class="form-group">
						<label for="lastname">Client's Last name:</label>
						<input type="text" class="form-control" id="lastname" ng-model="student.local.lastname">
					</div>
					<div class="form-group">
						<label for="lastname">Client's Company name:</label>
						<input type="text" class="form-control" id="lastname" ng-model="student.local.clientname">
					</div>
					<div class="form-group">
						<label for="lastname">Customer Onboarding Manager:</label>
						<select name="customerrep" id="customerrep" ng-model="onboardingSpecialist">
							<option ng-repeat="customerSupportRep in customerSupportReps" value="{{customerSupportRep._id}}">{{customerSupportRep.local.firstname}} {{customerSupportRep.local.lastname}}</option>
						</select>
					</div>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
					<button type="submit" class="btn btn-primary">Add Client</button>
				</div>
			</form>
		</div>
	</div>
</div>